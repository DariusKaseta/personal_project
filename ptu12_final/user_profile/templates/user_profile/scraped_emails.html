{% extends 'base.html' %}
{% block title %}Scraped emails {{ block.super }}{% endblock title %}
{% block content %}
<div class="left-column">
<h1 class="font">Scraped emails <span class="font-small">(in total - {{ email_count }})</span></h1>
    {% include 'includes/search.html' %}
    <p>
    {% if scrape_list %}
            {% with scrape_list as page_obj %}
                {% include 'includes/paginator_pages.html' %}
            {% endwith %}
    {% endif %}
    </p>
    <form method="post" action="{% url 'send_emails' %}">
        <p> 
            <button type="button" class="nav-button-link" onclick="selectAllEmails()">Select All</button>
            <button type="submit" class="nav-button-link">Transfer To:</button>
            <button type="button" class="nav-button-link" onclick="deselectAllEmails()">Deselect All</button>
        </p>
        {% csrf_token %}
        {% if user.is_authenticated %}
        <table>
            <tbody>
            {% for email in scrape_list %}
                <tr>
                    <td>
                        <input type="checkbox" id="{{ email.address }}" name="emails" value="{{ email.address }}">
                        <label for="{{ email.address }}">{{ email.address }}</label>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        {% endif %}
        <p> 
            <button type="button" class="nav-button-link" onclick="selectAllEmails()">Select All</button>
            <button type="submit" class="nav-button-link">Transfer To:</button>
            <button type="button" class="nav-button-link" onclick="deselectAllEmails()">Deselect All</button>
        </p>
        <p>
            {% if scrape_list %}
                    {% with scrape_list as page_obj %}
                        {% include 'includes/paginator_pages.html' %}
                    {% endwith %}
            {% endif %}
        </p>
<script>
    function selectAllEmails() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach((checkbox) => {
            checkbox.checked = true;
        });
    }
    
    function deselectAllEmails() {
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach((checkbox) => {
            checkbox.checked = false;
        });
    }
</script>
</div>
</form>
{% endblock %}